(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/public/chat-body"],{"04f7":function(t,e,o){"use strict";(function(t,e){var n=o("4ea4");o("b10a"),o("5c17"),o("a9ff");n(o("66fd"));var r=n(o("1c08"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(r.default)}).call(this,o("bc2e")["default"],o("543d")["createPage"])},"16c2":function(t,e,o){"use strict";o.r(e);var n=o("a683"),r=o.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},"1b8b":function(t,e,o){},"1c08":function(t,e,o){"use strict";o.r(e);var n=o("3b04"),r=o("16c2");for(var i in r)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return r[t]}))}(i);o("5fa6");var a=o("f0c5"),c=Object(a["a"])(r["default"],n["b"],n["c"],!1,null,"438c2df0",null,!1,n["a"],void 0);e["default"]=c.exports},"3b04":function(t,e,o){"use strict";o.d(e,"b",(function(){return r})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return n}));var n={ktNavBar:function(){return o.e("uni_modules/uniapp-kantboot/components/kt-nav-bar/kt-nav-bar").then(o.bind(null,"4a2b"))},followBtn:function(){return o.e("components/follow-btn/follow-btn").then(o.bind(null,"c265"))}},r=function(){var t=this.$createElement;this._self._c},i=[]},"5fa6":function(t,e,o){"use strict";var n=o("1b8b"),r=o.n(n);r.a},a683:function(t,e,o){"use strict";(function(t){var n=o("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(o("2eee")),i=n(o("c973")),a={components:{scrollViewBox:function(){o.e("pages/public/inChatBody/scrollViewBox").then(function(){return resolve(o("8cd7"))}.bind(null,o)).catch(o.oe)},chatInput:function(){o.e("pages/public/inChatBody/chatInput").then(function(){return resolve(o("d1e2"))}.bind(null,o)).catch(o.oe)}},data:function(){return{room:{id:null,typeCode:"privateChat",otherUser:null,name:null},bodyData:{content:[]},ovoUserSelf:{},navBarHeight:0,chatInputHeight:0,publishNum:0}},onLoad:function(e){if(this.ovoUserInfo=this.$ovo.getSelf(),null!=e.roomId)return this.room=t.getStorageSync("roomId:"+e.roomId+":room"),""==t.getStorageSync("roomId:"+e.roomId+":room")&&this.getRoomById(e.roomId),!1;if(null!=e.roomTypeCode){this.room.typeCode=e.roomTypeCode;var o=e.otherUserId;return this.room.otherUser=t.getStorageSync("userId:"+o+":ovoUserInfo"),this.room.name=this.room.otherUser.nickname,this.getPrivateChatRoomByOtherUserId(o),this.$forceUpdate(),!1}},mounted:function(){var e=this;t.createSelectorQuery().in(this).select("#navBar").boundingClientRect((function(t){e.navBarHeight=t.height})).exec(),t.createSelectorQuery().in(this).select("#chatInput").boundingClientRect((function(t){e.chatInputHeight=t.height})).exec(),setTimeout((function(){t.createSelectorQuery().in(e).select("#chatInput").boundingClientRect((function(t){e.chatInputHeight=t.height})).exec()}),100)},methods:{getPrivateChatRoomByOtherUserId:function(e){var o=this;this.$kt.request.request({api:this.$api.business.ovo.chatRoom.getPrivateChatRoomByOtherUserId,data:{otherUserId:e},stateSuccess:function(e){if(null!=e.data)return o.room=e.data,console.log(JSON.stringify(o.room),"-=-=-=-=-"),t.setStorageSync("roomId:"+o.room.roomId+":room",o.room),setTimeout((function(){o.$refs.scrollViewBox.getBodyData()}),100),null}})},chatInputChange:function(){var e=this;t.createSelectorQuery().in(this).select("#chatInput").boundingClientRect((function(t){e.chatInputHeight=t.height})).exec(),this.$refs.scrollViewBox.toBottom()},chatInputPublish:function(t){null==this.room.id&&(this.room.id=t.roomId,this.getRoomById(t.roomId))},getRoomById:function(e){var o=this;return(0,i.default)(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,new Promise((function(n,r){o.$kt.request.request({api:o.$api.business.ovo.chatRoom.getById,data:{id:e},stateSuccess:function(e){o.room=e.data,o.$refs.scrollViewBox.getBodyData(),t.setStorageSync("roomId:"+o.room.roomId+":room",o.room),n()}})}));case 2:case"end":return n.stop()}}),n)})))()}}};e.default=a}).call(this,o("543d")["default"])}},[["04f7","common/runtime","common/vendor"]]]);