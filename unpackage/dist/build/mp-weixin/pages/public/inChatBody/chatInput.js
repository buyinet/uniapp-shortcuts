(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/public/inChatBody/chatInput"],{"01b0":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));var i={uGrid:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-grid/u-grid")]).then(n.bind(null,"a6a0"))},uGridItem:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-grid-item/u-grid-item")]).then(n.bind(null,"4f9c"))}},o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.$kt.util.rpxToPx("40")),i=e.sendRequestParam.content.length>0&&!e.isPublishing,o=i?e.$kt.file.byPath("image/icon/send.svg"):null,a=i?null:e.$kt.file.byPath("image/icon/send.svg"),u=e.$kt.file.byPath("/image/chat/image.svg"),s=e.$kt.file.byPath("/image/chat/video.svg"),r=e.$kt.file.byPath("/image/chat/voice.svg"),c=e.$kt.file.byPath("/image/chat/expression.svg"),d=e.$kt.file.byPath("/image/icon/gift.svg");e.$mp.data=Object.assign({},{$root:{g0:n,g1:i,g2:o,g3:a,g4:u,g5:s,g6:r,g7:c,g8:d}})},a=[]},"4aef":function(e,t,n){"use strict";var i=n("6e92"),o=n.n(i);o.a},"6e92":function(e,t,n){},"7d59":function(e,t,n){"use strict";n.r(t);var i=n("cff7"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},cff7:function(e,t,n){"use strict";(function(e){var i=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n("2eee")),a=i(n("c973")),u={components:{voiceBox:function(){n.e("pages/public/inChatBody/inChatInput/voiceBox").then(function(){return resolve(n("2912"))}.bind(null,n)).catch(n.oe)}},props:{room:{type:Object,default:function(){return{}}}},data:function(){return{voiceBoxOpen:!1,sendRequestParam:{roomId:"",content:"",typeCode:"text",otherUserId:""},isPublishing:!1}},mounted:function(){null!=this.sendRequestParam.roomId&&(this.sendRequestParam.roomId=this.room.id,this.sendRequestParam.otherUserId=this.room.otherUser.userId)},methods:{openVoiceBox:function(){var e=this;this.voiceBoxOpen=!this.voiceBoxOpen,setTimeout((function(){e.$emit("change")}),100)},voiceBoxSubmit:function(e){var t=this;this.voiceBoxOpen=!1,setTimeout((function(){t.$emit("change")}),100),this.uploadFile(e.path,"voice",e.duration)},chooseImage:function(){var t=this;e.chooseImage({count:1,success:function(e){for(var n=e.tempFilePaths,i=0;i<n.length;i++)t.uploadFile(n[i],"image")}})},chooseVideo:function(){var t=this;e.chooseMedia({count:1,sourceType:["album","camera"],mediaType:["video"],maxDuration:60,camera:"back",success:function(e){var n=e.tempFiles[0].tempFilePath;t.uploadFile(n,"video")}})},uploadFile:function(t,n,i){var u=this;return(0,a.default)(o.default.mark((function a(){return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.showLoading({title:"正在上传"}),o.next=3,new Promise((function(o,a){u.$kt.request.uploadFile({name:"file",formData:{groupCode:"chat"},filePath:t,success:function(t){var a=JSON.parse(t.data);u.publish(a.data.id,n,i),setTimeout((function(){e.hideLoading()}),2e3),o()},fail:function(e){a()}})}));case 3:case"end":return o.stop()}}),a)})))()},input:function(e){this.voiceBoxOpen=!1,this.sendRequestParam.content=e.detail.value},publish:function(e,t,n){"privateChat"==this.room.typeCode&&this.chatPrivate(e,t,n)},chatPrivate:function(t,n,i){var o=this;return new Promise((function(a,u){if(o.isPublishing)return falsee;o.isPublishing=!0,o.$kt.request.request({api:o.$api.business.ovo.chat.chatPrivate,data:{otherUserId:o.sendRequestParam.otherUserId,content:t,typeCode:n,duration:i},stateSuccess:function(t){o.sendRequestParam.content="";var n=t.data;n.ovoUserOfSend=o.ovoUserInfo,e.$emit("newChat:roomId:"+o.room.roomId,n),o.isPublishing=!1,o.$forceUpdate(),o.$emit("publish",n),setTimeout((function(){o.$emit("change")}),200),a()}})}))}},watch:{sendRequestParam:{handler:function(e,t){console.log("变化了"),this.$emit("change")},deep:!0}}};t.default=u}).call(this,n("543d")["default"])},d1e2:function(e,t,n){"use strict";n.r(t);var i=n("01b0"),o=n("7d59");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("4aef");var u=n("f0c5"),s=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,"1fd76646",null,!1,i["a"],void 0);t["default"]=s.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/public/inChatBody/chatInput-create-component',
    {
        'pages/public/inChatBody/chatInput-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("d1e2"))
        })
    },
    [['pages/public/inChatBody/chatInput-create-component']]
]);
