(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/public/post-body"],{"4b96":function(t,e,n){},"56d2":function(t,e,n){"use strict";(function(t,e){var o=n("4ea4");n("b10a"),n("5c17"),n("a9ff");o(n("66fd"));var i=o(n("eb5d"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(i.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},8376:function(t,e,n){"use strict";n.r(e);var o=n("bab3"),i=n.n(o);for(var s in o)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},b463:function(t,e,n){"use strict";var o=n("4b96"),i=n.n(o);i.a},bab3:function(t,e,n){"use strict";(function(t){var o=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n("2eee")),s=o(n("c973")),a=o(n("9523"));function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){(0,a.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c={components:{auditStatusCodeIsWait:function(){n.e("pages/public/inPostBody/auditStatusCodeIsWait").then(function(){return resolve(n("775f"))}.bind(null,n)).catch(n.oe)}},data:function(){return{statusBarHeight:t.getSystemInfoSync().statusBarHeight,navHeight:48,navBarHeight:48,isPublishing:!1,postId:"",bodyData:{},postAtSelect:null,postCommentData:{content:[]},postRequestParam:{pageNumber:1},publishRequestParam:{content:""},onShowNumber:0,clearPostAtSelectClick:0,publishBoxHeight:0,isPostInit:!1,isPostCommentInit:!1,timeOut:null}},onLoad:function(e){this.navHeight=44,this.navHeight=-1!=t.getSystemInfoSync().system.indexOf("ios")?44:48,this.navBarHeight=this.statusBarHeight- -this.navHeight,this.postId=e.postId,t.showLoading({title:"加载中"}),this.getById(this.postId),t.hideLoading(),this.getPostComment()},onShow:function(){this.onShowNumber++,this.onShowNumber>1&&(this.postCommentData.content=[],this.postRequestParam.pageNumber=1,this.getPostComment())},mounted:function(){var e=this;t.createSelectorQuery().in(this).select("#publishBox").boundingClientRect((function(t){e.publishBoxHeight=t.height})).exec()},methods:{publishBoxHeightSet:function(){var e=this;t.createSelectorQuery().in(this).select("#publishBox").boundingClientRect((function(t){e.publishBoxHeight=t.height})).exec()},inputPublishInput:function(t){this.publishBoxHeightSet()},clearPostAtSelect:function(){var t=this;this.clearPostAtSelectClick++,this.clearPostAtSelectClick>1&&(this.postAtSelect=null,this.clearPostAtSelectClick=0),this.timOut=setTimeout((function(){t.clearPostAtSelectClick=0}),3e3)},toAtPost:function(t){var e=this;clearTimeout(this.timOut),this.postAtSelect=t,setTimeout((function(){e.publishBoxHeightSet()}),100)},like:function(t){for(var e=this,n=[],o=0;o<this.postCommentData.content.length;o++)if(this.postCommentData.content[o].id==t){if(this.postCommentData.content[o].isLikeOpting)return!1;n.push(o)}for(o=0;o<n.length;o++)this.postCommentData.content[n[o]].isLikeOpting=!0,setTimeout((function(){e.postCommentData.content[n[o]].isLikeOpting=!1}),1e3);this.$kt.request.request({api:this.$api.business.ovo.postComment.like,data:{commentId:t},stateSuccess:function(t){for(var n=t.data,o=0;o<e.postCommentData.content.length;o++)e.postCommentData.content[o].id==n.id&&(e.postCommentData.content[o]=n);e.$forceUpdate()}})},publish:function(){var t=this;return!this.isPublishing&&(null==this.publishRequestParam.content||""==this.publishRequestParam.content?(console.log("没有内容"),!1):(this.isPublishing=!0,void this.$kt.request.request({api:this.$api.business.ovo.postComment.publish,data:{postId:this.postId,content:this.publishRequestParam.content,atCommentId:null!=this.postAtSelect?this.postAtSelect.id:null},stateSuccess:function(e){t.postCommentData.content.unshift(r(r({},e.data),{},{ovoUser:t.$ovo.getSelf()})),t.publishRequestParam.content="",t.postAtSelect=null,t.bodyData.commentCount++,t.getById(t.postId),t.$forceUpdate(),t.isPublishing=!1,setTimeout((function(){t.publishBoxHeightSet()}),100)}})))},copyContent:function(e){t.setClipboardData({data:e,success:function(){t.showToast({title:"复制成功",icon:"success"})}})},getById:function(e){var n=this;return(0,s.default)(i.default.mark((function o(){return i.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,new Promise((function(o){n.$kt.request.request({api:n.$api.business.ovo.post.getById,data:{id:e},stateSuccess:function(e){n.bodyData=e.data,t.$emit("changeOvoPost",n.bodyData),n.$forceUpdate(),n.isPostInit=!0,o()}})}));case 2:case"end":return o.stop()}}),o)})))()},getPostComment:function(){var t=this;return(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.$kt.request.request({api:t.$api.business.ovo.postComment.getByPostId,data:{postId:t.postId,pageNumber:t.postRequestParam.pageNumber},stateSuccess:function(n){t.postRequestParam.pageNumber++,0==n.data.content.length&&t.postRequestParam.pageNumber--;for(var o=0;o<n.data.content.length;o++){for(var i=0;i<t.postCommentData.content.length;i++)if(t.postCommentData.content[i].id==n.data.content[o].id){t.postCommentData.content[i]=n.data.content[o];break}t.postCommentData.content.push(r(r({},n.data.content[o]),{},{isLikeOpting:!1}))}t.isPostCommentInit=!0,t.$forceUpdate(),e()}})}));case 2:case"end":return e.stop()}}),e)})))()}}};e.default=c}).call(this,n("543d")["default"])},eb5d:function(t,e,n){"use strict";n.r(e);var o=n("fdd1"),i=n("8376");for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("b463");var a=n("f0c5"),u=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,"1e4b9e69",null,!1,o["a"],void 0);e["default"]=u.exports},fdd1:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}));var o={ktNavBar:function(){return n.e("uni_modules/uniapp-kantboot/components/kt-nav-bar/kt-nav-bar").then(n.bind(null,"4a2b"))},followBtn:function(){return n.e("components/follow-btn/follow-btn").then(n.bind(null,"c265"))},userPost:function(){return n.e("components/user-post/user-post").then(n.bind(null,"4621"))},userCard:function(){return n.e("components/user-card/user-card").then(n.bind(null,"26a1"))},uDivider:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-divider/u-divider")]).then(n.bind(null,"7f96"))}},i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.isPostInit&&"pass"==t.bodyData.auditStatusCode?t.postCommentData.content.length:null),o=t.isPostInit&&"pass"==t.bodyData.auditStatusCode&&0==n?t.$kt.file.byPath("image/icon/noHaveComment.svg"):null,i=t.isPostInit&&"pass"==t.bodyData.auditStatusCode?t.__map(t.postCommentData.content,(function(e,n){var o=t.__get_orig(e),i=e.like?t.$kt.file.byPath("image/icon/likeFill.svg"):null,s=e.like?null:t.$kt.file.byPath("image/icon/like.svg");return{$orig:o,g2:i,g3:s}})):null,s="pass"==t.bodyData.auditStatusCode?t.$kt.util.rpxToPx("40"):null,a="pass"!=t.bodyData.auditStatusCode||""==t.publishRequestParam.content||null==t.publishRequestParam.content||t.isPublishing?null:t.$kt.file.byPath("image/icon/send.svg"),u="pass"!=t.bodyData.auditStatusCode||""!=t.publishRequestParam.content&&null!=t.publishRequestParam.content&&!t.isPublishing?null:t.$kt.file.byPath("image/icon/send.svg");t.$mp.data=Object.assign({},{$root:{g0:n,g1:o,l0:i,g4:s,g5:a,g6:u}})},s=[]}},[["56d2","common/runtime","common/vendor"]]]);